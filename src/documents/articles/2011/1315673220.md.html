---
layout: 'article'
title: 'syntaxhighlighter for tumblr'
author: 'Changwoo Park'
date: '2011-09-10'
tags: ["tumblr","syntaxhighlighter","markdown"]
---

<p>그동안 <a href="http://dogfeet.tistory.com">tistory</a>에서 javascript로 markdown을 사용하고 있었는데 여러가지 불편한점이 많아서 tumblr로 옮길 계획을 세웠습니다.</p>

<p>아무리 blog가 이슈가 되는 시대는 지났다지만 다음은 tistory를 버린건 아닐까요&#8212;;;.</p>

<p>서비스형 블로그, 팀 블로그, markdown 편집기, css와 js 수정가능, 공짜, 예쁠것 등등의 것이 필요했습니다. 이 정도는 돼야 블로그에서도 소를 키울 수 있을 것 같습니다&#8230;</p>

<h4>syntax highlighter</h4>

<p>대부분은 코드와 관련돼 있기 때문에 syntax highlighting 기능이 필요합니다.</p>

<p>이 <a href="http://alexgorbatchev.com/SyntaxHighlighter/">syntax highlighter</a>는 Alex Gorbatchev 것을 이용하고 사용법만 조금 수정한 것입니다. 소스코드는 <a href="https://github.com/pismute/jquery.syntaxhighlighter">GitHub</a>에 있습니다. 직접 이 페이지의 소스를 보셔도 됩니다.</p>

<h4>markdown</h4>

<p>markdown에서 코드를 작성하면:</p>

<pre><code>[1tab or 4spaces]나는 코드다
</code></pre>

<p>다음과 같이 바꿔줍니다.</p>

<pre><code>&lt;pre&gt;&lt;code&gt;나는 코드다&lt;/code&gt;&lt;pre&gt;
</code></pre>

<h4>syntax highlight</h4>

<p>거의 기본 설정을 그대로 쓰면 여기서 예시하는 대로 써도 되지만 뭔가 수정하려면 Alex씨의 설명서를 읽어야 합니다.</p>

<p>먼저 필요한 파일들을 포함시킵니다:</p>

<pre><code>&lt;link rel=vstylesheet" type="text/css"
  href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css" /&gt;
&lt;link rel="stylesheet" type="text/css"
  href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeEmacs.css" /&gt;

&lt;script type="text/javascript" 
  src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"
  src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.3/jquery.min.js"&gt;&lt;/script&gt;
</code></pre>

<p>그리고 github에서 받은 javascript 파일을 첨부합니다. 저는 테마에 그냥 파일내용을 전부 넣어버렸습니다.&#8212;;; 어디 서버에 올려놓고 링크만 하고 싶습니다, 그리고 highlight시킵니다.</p>

<p>markdown의 코드를 highlight시킵니다:</p>

<pre><code>#!js
&lt;script type="text/javascript"&gt;
  $(function(){
    $('pre &gt; code').highlight();
  });
&lt;/script&gt;
</code></pre>

<p>Alex씨의 버전을 그대로 사용하지 않은 이유는 여기에 있습니다. 어떤 DOM을 highlight할지 selector를 이용해서 결정하고 싶었기에 wrapper를 따로 만든 것입니다.</p>

<p>오리지널 버전에서는 태그의 class속성에 <code>brush; js</code>등의 방법으로 코드의 언어가 무었인지 명시할 수 있었지만 markdown의 특성상 그럴수가 없었습니다.</p>

<p>그래서 auto-detect 컨셉이 구현된 것을 찾아봤는데 <a href="http://balupton.github.com/jquery-syntaxhighlighter/demo/">Google’s prettify릴 이용한 jquery plugin</a>이 있었습니다.</p>

<p>적용해보니 tumblr의 테마에 영향을 받더군요. 그래서 syntax highdarker가 돼버렸습니다.</p>

<p>그래서 꼼수를 부리기로 했습니다. 쉘의 #!처럼 지시자를 적도록 했습니다. 첫 줄의 첫 문자가 #!라면 그 다음에 오는 것을 언어로 인식하도록 했습니다. 그리고 #!지시자가 있으면 자동으로 첫 줄은 삭제하고 보여줍니다.</p>

<pre><code>//#!java
public class SampleJava{}
</code></pre>

<p>//가 없으면 파싱해버리기 때문에 집어 넣은 것입니다. //가 없다고 하면 다음과 같이 보여집니다:</p>

<pre><code>#!java
public class SampleJava{}
</code></pre>

<p>#!생략하는 경우에는 바로 이전에 사용한 brush를 사용합니다. 만약 처음 사용하는 것이라면 xml을 brush를 사용합니다.</p>

<p>만약 위의 예제에서 #!을 생략해도:</p>

<pre><code>public class SampleJava{}
</code></pre>

<p>같은 바로 이전에 java brush를 사용했기 때문에 여기서도 java brush를 사용합니다.</p>